import org.jetbrains.kotlin.UtilsKt

project.buildscript.repositories {
    maven {
        url BootstrapKt.getBootstrapKotlinRepo(project)
    }
    if (UtilsKt.getCacheRedirectorEnabled(project))
        maven { url 'https://cache-redirector.jetbrains.com/maven-central' }
    else
        mavenCentral()
}

project.buildscript.dependencies {
    classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:${project.bootstrapKotlinVersion}"
}

configurations {
    kotlinCompilerClasspath {
        canBeConsumed = false
        canBeResolved = true
        attributes {
            attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage.JAVA_RUNTIME))
            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, objects.named(LibraryElements.JAR))
        }
    }
}

if (!(project.findProperty("withoutEmbedabble")?.toString()?.toBoolean() ?: false)) {
    project.dependencies {
        kotlinCompilerClasspath(project(":kotlin-compiler-embeddable"))
    }
}
